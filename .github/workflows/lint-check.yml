# â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
# â•‘  REUSABLE: Lint & Code Style                                   â•‘
# â•‘  ESLint + Prettier for JS/TS projects                         â•‘
# â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
name: "Reusable: Lint & Code Style"

on:
  workflow_call:
    inputs:
      working-directory:
        required: false
        type: string
        default: "."
        description: "Project directory"
      system-name:
        required: true
        type: string
        description: "System name for display"
      node-version:
        required: false
        type: number
        default: 20
        description: "Node.js version"
      lint-command:
        required: false
        type: string
        default: "npx eslint . --max-warnings=0"
        description: "Lint command to run"
      format-check-command:
        required: false
        type: string
        default: ""
        description: "Format check command (e.g. npx prettier --check .)"
      fail-on-warning:
        required: false
        type: boolean
        default: false
        description: "Fail on ESLint warnings"
    outputs:
      lint-result:
        description: "Lint pass/fail"
        value: ${{ jobs.lint-check.outputs.result }}

jobs:
  lint-check:
    name: "Lint & Style Check"
    runs-on: ubuntu-latest
    outputs:
      result: ${{ steps.lint.outcome }}
    defaults:
      run:
        working-directory: ./${{ inputs.working-directory }}
    steps:
      - name: Checkout Code
        uses: actions/checkout@v4

      - name: Setup Node.js ${{ inputs.node-version }}
        uses: actions/setup-node@v4
        with:
          node-version: ${{ inputs.node-version }}
          cache: "npm"
          cache-dependency-path: |
            **/package-lock.json

      - name: Install Dependencies
        run: npm ci --ignore-scripts

      - name: Run Linter
        id: lint
        run: |
          echo "ğŸ” Running lint checks..."
          ${{ inputs.lint-command }}
          echo "âœ… Lint checks passed"

      - name: Check Code Formatting
        if: ${{ inputs.format-check-command != '' }}
        run: |
          echo "ğŸ¨ Checking code formatting..."
          ${{ inputs.format-check-command }}
          echo "âœ… Formatting is consistent"
